"use strict";const t="'([^']+)'|\"([^\"]+)\"|[\\w\\s-]+";RegExp("(bold|bolder|lighter|[1-9]00) +","i"),RegExp("(italic|oblique) +","i"),RegExp("(small-caps) +","i"),RegExp("(ultra-condensed|extra-condensed|condensed|semi-condensed|semi-expanded|expanded|extra-expanded|ultra-expanded) +","i"),RegExp(`([\\d\\.]+)(px|pt|pc|in|cm|mm|%|em|ex|ch|rem|q) *((?:${t})( *, *(?:${t}))*)`);const e=new class{getContext2d(t,e){}resizeImage(t,e,r){let n;if("undefined"==typeof window){let t=Object.assign(document.createElement("canvas"),{width:e,height:r});n=t.getContext("2d")}else{let l=document.createElement("canvas");l.width=e,l.height=r,t.setAttribute("crossOrigin","Anonymous"),n=l.getContext("2d")}return n.webkitImageSmoothingEnabled=!0,n.msImageSmoothingEnabled=!0,n.mozImageSmoothingEnabled=!0,n.imageSmoothingEnabled=!0,n.imageSmoothingQuality="high",n.drawImage(t,0,0,e,r),n.getImageData(0,0,e,r).data}},r=new class{convert(t){let e=new Uint8ClampedArray(t.length/4),r=0;for(let n=0;n<t.length;n+=4)e[r++]=Math.round(299*t[n]/1e3+587*t[n+1]/1e3+114*t[n+2]/1e3);return e}};class n{binArray;constructor(t){this.binArray=t}static fromBase64(t){let e=atob(t),r=new Uint8ClampedArray(8*e.length);for(let t=0;t<e.length;t++){let n=e.charCodeAt(t);r[8*t]=1&n,r[8*t+1]=(2&n)>>1,r[8*t+2]=(4&n)>>2,r[8*t+3]=(8&n)>>3,r[8*t+4]=(16&n)>>4,r[8*t+5]=(32&n)>>5,r[8*t+6]=(64&n)>>6,r[8*t+7]=(128&n)>>7}return new n(r)}static fromHexStringReversed(t){if(t.length%2!=0)throw Error("hex string length must be a multiple of 2");let e=new Uint8ClampedArray(4*t.length);for(let r=0;r<t.length;r+=2){let n=Number.parseInt(t.slice(r,r+2),16);if(Number.isNaN(n))throw Error("Invalid hex string");e[4*r]=(128&n)>>7,e[4*r+1]=(64&n)>>6,e[4*r+2]=(32&n)>>5,e[4*r+3]=(16&n)>>4,e[4*r+4]=(8&n)>>3,e[4*r+5]=(4&n)>>2,e[4*r+6]=(2&n)>>1,e[4*r+7]=1&n}return new n(e)}static fromHexString(t){if(t.length%2!=0)throw Error("hex string length must be a multiple of 2");let e=new Uint8ClampedArray(4*t.length);for(let r=0;r<t.length;r+=2){let n=Number.parseInt(t.slice(r,r+2),16);if(Number.isNaN(n))throw Error("Invalid hex string");e[4*r]=1&n,e[4*r+1]=(2&n)>>1,e[4*r+2]=(4&n)>>2,e[4*r+3]=(8&n)>>3,e[4*r+4]=(16&n)>>4,e[4*r+5]=(32&n)>>5,e[4*r+6]=(64&n)>>6,e[4*r+7]=(128&n)>>7}return new n(e)}toHexStringReversed(){let t="";for(let e=0;e<this.binArray.length;e+=8){let r=this.binArray[e]<<7|this.binArray[e+1]<<6|this.binArray[e+2]<<5|this.binArray[e+3]<<4|this.binArray[e+4]<<3|this.binArray[e+5]<<2|this.binArray[e+6]<<1|this.binArray[e+7];t+=r.toString(16).padStart(2,"0")}return t}toHexString(){let t="";for(let e=0;e<this.binArray.length;e+=8){let r=this.binArray[e]|this.binArray[e+1]<<1|this.binArray[e+2]<<2|this.binArray[e+3]<<3|this.binArray[e+4]<<4|this.binArray[e+5]<<5|this.binArray[e+6]<<6|this.binArray[e+7]<<7;t+=r.toString(16).padStart(2,"0")}return t}toBase64(){let t=[];for(let e=0;e<this.binArray.length;e+=8)t.push(this.binArray[e]|this.binArray[e+1]<<1|this.binArray[e+2]<<2|this.binArray[e+3]<<3|this.binArray[e+4]<<4|this.binArray[e+5]<<5|this.binArray[e+6]<<6|this.binArray[e+7]<<7);return btoa(String.fromCharCode(...new Uint8Array(t)))}hammingDistance(t){if(t.binArray.length!==this.binArray.length)throw Error("Cannot compare two ImageHash instances of different sizes");let e=0;for(let r=0;r<this.binArray.length;r++)this.binArray[r]!==t.binArray[r]&&(e+=1);return e}}const l=function(t){let e=t.slice().reverse().map((t,e)=>e%2==0?t:-t);return{dec:{low:t.slice(),high:e.slice()},rec:{low:t.slice(),high:e.slice()}}}([1/Math.SQRT2,1/Math.SQRT2]);function a(t){if("haar"===t)return l;throw Error("Invalid wavelet")}function i(t,e){return t.reduce((t,r,n)=>t+r*e[n],0)}function o(t,e){return t.map((t,r)=>t+e[r])}function h(t,e,r){let n=[],l=t.slice();for(let t=0;t<r;t++){let t=function(t,e){let r=a(e),n=r.dec,l=n.low.length,o=[],h=[];for(let e=0;e+l<=t.length;e+=2){let r=t.slice(e,e+l);o.push(i(r,n.low)),h.push(i(r,n.high))}return[o,h]}(l,e);l=t[0],n.unshift(t[1].slice())}return n.unshift(l.slice()),n}function s(t,e){e=a(e);let r=t[0];for(let n=1;n<t.length;n++){let l=t[n];r.length===l.length+1&&(r=r.slice(0,r.length-1)),r=function(t,e,r){let n=r.rec,l=n.low.length,a=t.length,i=Array(l+(a-1)*2);i.fill(0);for(let r=0;r<a;r++){let a=2*r,h=i.slice(a,a+l);h=o(h,function(t,e){return e.map(e=>t*e)}(t[r],n.low)),h=o(h,function(t,e){return e.map(e=>t*e)}(e[r],n.high)),i=i.slice(0,a).concat(h).concat(i.slice(a+h.length))}return i.slice(l-2,i.length-(l-2))}(r,l,e)}return r.slice()}function g(t,e,r){let n=Math.round(Math.sqrt(t.length)),l=Array(n);for(let e=0;e<n;e++){let r=Array(n);for(let l=0;l<n;l++)r[l]=t[e*n+l];l[e]=r}let a=Array(n);for(let t=0;t<n;t++)a[t]=Array(n);for(let t=0;t<n;t++){let e=h(l[t],"haar",r).flat();for(let r=0;r<n;r++)a[r][t]=e[r]}let i=Array(n*n);for(let t=0;t<n;t++){let e=h(a[t],"haar",r).flat();for(let r=0;r<n;r++)i[r*n+t]=e[r]}return i}function f(t,e){let r=[],n=[],l=t.length;for(let t=0;t<e;t++)n.unshift(l/=2);n.unshift(l);let a=0;for(let e=0;e<n.length;e++)r.push(t.slice(a,a+n[e])),a+=n[e];return r}window.ahash=function(t,l=8){let a=r.convert(e.resizeImage(t,l,l)),i=new Uint8ClampedArray(l*l),o=0;for(let t=0;t<a.length;t++)o+=a[t];let h=o/a.length;for(let t=0;t<a.length;t++)i[t]=a[t]>h;return new n(i)},window.dhash=function(t,l=8){let a=r.convert(e.resizeImage(t,l+1,l)),i=new Uint8ClampedArray(l*l),o=l+1,h=0;for(let t=0;t<l;t++)for(let e=1;e<o;e++)i[h++]=a[t*o+e]>a[t*o+e-1];return new n(i)},window.phash=function(t,l=8,a=4){let i=l*a,o=r.convert(e.resizeImage(t,i,i)),h=function(t){let e=Math.round(Math.sqrt(t.length)),r=Math.PI/(2*e),n=new Float64Array(e*e);for(let l=0;l<e;l++)for(let a=0;a<e;a++){let i=0,o=l*r,h=a*r;for(let r=0;r<e;r++)for(let n=0;n<e;n++)i+=t[r*e+n]*Math.cos((2*r+1)*o)*Math.cos((2*n+1)*h);n[l*e+a]=i}return n}(o),s=new Float64Array(l*l),g=new Float64Array(l*l),f=0,c=0;for(let t=0;t<l;t++){for(let t=0;t<l;t++)s[f]=h[c],g[f]=h[c],f+=1,c+=1;c+=i-l}for(let t=0;t<s.length;t++)s[t];let u=(g.sort((t,e)=>t-e),g[Math.floor(g.length/2)]),d=new Uint8ClampedArray(l*l);for(let t=0;t<d.length;++t)d[t]=s[t]>u;return new n(d)},window.whash=function(t,l=8,a=!0){let i=2**Math.floor(Math.log2(Math.min(t.width,t.height))),o=Math.max(i,l),h=Math.floor(Math.log2(o)),c=Math.floor(Math.log2(l)),u=h-c,d=r.convert(e.resizeImage(t,o,o)),m=Array(d.length);for(let t=0;t<d.length;t++)m[t]=d[t]/255;if(a){let t=g(m,"haar",h);t[0]=0,m=function(t,e,r){let n=Math.round(Math.sqrt(t.length)),l=Array(n);for(let e=0;e<n;e++){let r=Array(n);for(let l=0;l<n;l++)r[l]=t[l*n+e];l[e]=r}let a=Array(n);for(let t=0;t<n;t++)a[t]=Array(n);for(let t=0;t<n;t++){let e=s(f(l[t],r),"haar");for(let r=0;r<n;r++)a[r][t]=e[r]}let i=Array(n*n);for(let t=0;t<n;t++){let e=s(f(a[t],r),"haar");for(let r=0;r<n;r++)i[t*n+r]=e[r]}return i}(t,0,h)}let y=g(m,"haar",u),A=new Float64Array(l*l),w=new Float64Array(l*l),b=0,p=0;for(let t=0;t<l;t++){for(let t=0;t<l;t++)A[p]=y[b],w[p]=y[b],b+=1,p+=1;b+=o-l}let x=new Uint8ClampedArray(l*l),M=(w.sort((t,e)=>t-e),w[Math.floor(w.length/2)]);for(let t=0;t<x.length;t++)x[t]=A[t]>M;return new n(x)},window.ImageHash=n;